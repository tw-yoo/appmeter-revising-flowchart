flowchart TB

	I[/req: movementIdOrdMapping/]
	subgraph UpdateRoadNetwork

	subgraph req.forEach 
		it["(movement, ordList) ->"]

		UpdateOrdList2["
			lastEligibleGpsRecord = movement.gpsRecord
			.maxOf{ord < min(ordList)}
			?: 0
		"]

		GetLatestEligibleGpsRecord2["
			make buffer(r=0.003) polygon with gpsRecord list with: 
			ordList.map { it -> latest gpsRecord where ord <= it and eligible }
		"]

		GetRoadLink2["
			get and add roadLinks which intersect with buffer
			get roadNodes which intersect with buffer
		"]

		it --> UpdateOrdList2 --> GetLatestEligibleGpsRecord2 --> GetRoadLink2

	end
		
	end

I --> UpdateRoadNetwork